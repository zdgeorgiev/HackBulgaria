
public class MergeSort {

    public void sort(int[] arr) {
        topDownSplit(arr, 0, arr.length);
    }

    private void topDownSplit(int[] array, int start, int end) {

        // Only one element is sorted
        if (end - start < 2) {
            return;
        }

        int middle = (end + start) / 2;
        topDownSplit(array, start, middle);
        topDownSplit(array, middle, end);
        merge(array, start, middle, end);
    }

    private void merge(int[] array, int start, int middle, int end) {

        // Arrays which holds the sorted sublist
        int[] temp = new int[array.length];
        int index = 0;

        int firstArrayIndex = start;
        int secondArrayIndex = middle;

        int firstArrayNumber = array[firstArrayIndex];
        int secondArrayNumber = array[secondArrayIndex];

        for (int i = 0; i < end - start; i++) {

            // If one of the arrays reached its end add all others
            if (firstArrayIndex == middle) {
                while (secondArrayIndex != end) {
                    secondArrayNumber = array[secondArrayIndex++];
                    temp[index] = secondArrayNumber;
                    index++;
                }
                break;
            } else if (secondArrayIndex == end) {
                while (firstArrayIndex != middle) {
                    firstArrayNumber = array[firstArrayIndex++];
                    temp[index] = firstArrayNumber;
                    index++;
                }
                break;
            }

            firstArrayNumber = array[firstArrayIndex];
            secondArrayNumber = array[secondArrayIndex];

            if (firstArrayNumber < secondArrayNumber) {
                temp[index] = firstArrayNumber;
                index++;
                firstArrayIndex++;
            } else {
                temp[index] = secondArrayIndex;
                index++;
                secondArrayIndex++;
            }
        }

        copy(array, start, end, temp);
    }

    private void copy(int[] array, int start, int end, int[] temp) {

        for (int i = 0; i < end - start; i++) {
            array[start + i] = temp[i];
        }
    }
}
